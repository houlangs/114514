import{e as i,u as F,f as j,r as u,o as A,c as G,b as s,a,w as r,d as N,t as K,g as q}from"./index-8ffd0240.js";import{a as g}from"./axios-99a7d01f.js";const H={class:"card"},J=s("h4",{class:"m-0"},"角色列表",-1),Q={class:"flex flex-wrap gap-2 align-items-center justify-content-between"},W={class:"p-input-icon-left"},X=s("i",{class:"pi pi-search"},null,-1),Y={class:"p-buttonset"},Z={class:"field"},ee=s("label",{for:"name"},"角色名称",-1),le={class:"confirmation-content"},te=s("i",{class:"pi pi-exclamation-triangle mr-3",style:{"font-size":"2rem"}},null,-1),ae={class:"p-float-label mt-4"},oe=s("label",{for:"number-input"},"角色ID",-1),de={__name:"UserRole",setup(se){const C=i(),c=i(!1),f=i(!1);let n=i();const k=i(),b=i(),w=i(),h=i({global:{value:null,matchMode:q.CONTAINS}}),_=i(),y=i(),p=F();j(()=>{m()});const m=()=>{g.get("/role/list",{params:{page:1,pageSize:10}}).then(function(l){C.value=l.data.data.records}).catch(function(l){console.log(l)})},S=(l,e,t)=>{g.post("/role/edit",{id:l,roleTab:e,roleName:t}).then(function(d){d.data.code===200?(c.value=!1,p.add({severity:"success",summary:"SUCCESS",detail:d.data.msg,life:3e3})):(console.log(d.data),p.add({severity:"error",summary:"ERROR",detail:d.data.msg,life:3e3})),m()}).catch(function(d){m(),console.log(d)})},D=(l,e)=>{g.post("/role/add",{roleTab:l,roleName:e}).then(function(t){t.data.code===200?(c.value=!1,p.add({severity:"success",summary:"SUCCESS",detail:t.data.msg,life:3e3})):(console.log(t.data),p.add({severity:"error",summary:"ERROR",detail:t.data.msg,life:3e3})),m()}).catch(function(t){m(),console.log(t)})},T=(l,e)=>{g.post("/role/delete",{id:l,newRoleId:e}).then(function(t){t.data.code===200?(c.value=!1,f.value=!1,p.add({severity:"success",summary:"SUCCESS",detail:t.data.msg,life:3e3})):(console.log(t.data),p.add({severity:"error",summary:"ERROR",detail:t.data.msg,life:3e3})),m()}).catch(function(t){m(),console.log(t)})},V=l=>{g.get("/role/get_count",{params:{id:l}}).then(function(e){_.value=e.data.data}).catch(function(e){console.log(e)})},I=()=>{n.value={},c.value=!0},P=()=>{c.value=!1,n.value={}},U=l=>{n.value=l,k.value=n.value.roleTab,b.value=n.value.roleName,c.value=!0},E=l=>{n.value=l,V(n.value.id),f.value=!0},L=()=>{const l=n.value.id,e=y.value;_.value==0?T(l):T(l,e),n.value={}},M=()=>{const l=n.value.id,e=k.value,t=b.value;n.value.id!=null?S(l,e,t):D(e,t)};return(l,e)=>{const t=u("Toolbar"),d=u("InputText"),v=u("Button"),R=u("Column"),O=u("DataTable"),B=u("Toast"),x=u("Dialog"),z=u("InputNumber");return A(),G("div",null,[s("div",H,[a(t,{class:"mb-4"},{start:r(()=>[J]),_:1}),a(O,{showGridlines:"",value:C.value,selection:w.value,"onUpdate:selection":e[1]||(e[1]=o=>w.value=o),dataKey:"id",columnResizeMode:"fit",paginator:!0,rows:10,filters:h.value,paginatorTemplate:"FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink CurrentPageReport RowsPerPageDropdown",rowsPerPageOptions:[5,10,25],currentPageReportTemplate:"第 {first} 页，本页 {last} 条记录，共 {totalRecords} 条记录"},{header:r(()=>[s("div",Q,[s("span",W,[X,a(d,{modelValue:h.value.global.value,"onUpdate:modelValue":e[0]||(e[0]=o=>h.value.global.value=o),placeholder:"搜索"},null,8,["modelValue"])]),a(v,{label:"添加",icon:"pi pi-plus",severity:"success",class:"mr-2",onClick:I})])]),default:r(()=>[a(R,{field:"id",header:"ID",style:{"min-width":"2rem"}}),a(R,{field:"roleName",header:"角色名称",style:{"min-width":"8rem"}}),a(R,{exportable:!1,style:{"min-width":"8rem"}},{body:r(o=>[s("span",Y,[a(v,{label:"编辑",icon:"pi pi-pencil",onClick:$=>U(o.data)},null,8,["onClick"]),a(v,{label:"删除",icon:"pi pi-trash",severity:"danger",onClick:$=>E(o.data)},null,8,["onClick"])])]),_:1})]),_:1},8,["value","selection","filters"])]),a(B),a(x,{visible:c.value,"onUpdate:visible":e[3]||(e[3]=o=>c.value=o),style:{width:"450px"},header:"编辑角色",modal:!0,class:"p-fluid"},{footer:r(()=>[a(v,{text:"",label:"取消",icon:"pi pi-times",onClick:P}),a(v,{text:"",label:"确认",icon:"pi pi-check",onClick:M})]),default:r(()=>[s("div",Z,[ee,a(d,{id:"name",modelValue:b.value,"onUpdate:modelValue":e[2]||(e[2]=o=>b.value=o),modelModifiers:{trim:!0},autofocus:"",placeholder:"普通用户"},null,8,["modelValue"])])]),_:1},8,["visible"]),a(x,{visible:f.value,"onUpdate:visible":e[6]||(e[6]=o=>f.value=o),style:{width:"450px"},header:"确认删除",modal:!0},{footer:r(()=>[a(v,{label:"取消",icon:"pi pi-times",onClick:e[5]||(e[5]=o=>f.value=!1)}),a(v,{label:"确认",icon:"pi pi-check",onClick:L})]),default:r(()=>[s("div",le,[te,s("span",null,[N("该角色隶属于"),s("b",null,K(_.value),1),N("位用户，请重新为他们分配新的角色")]),s("span",ae,[a(z,{id:"number-input",modelValue:y.value,"onUpdate:modelValue":e[4]||(e[4]=o=>y.value=o),disabled:_.value==0},null,8,["modelValue","disabled"]),oe])])]),_:1},8,["visible"])])}}};export{de as default};
