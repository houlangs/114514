import{e as s,u as Z,h as ee,f as le,r as m,o as V,c as x,b as o,a as t,w as r,F,i as B,g as te,t as z}from"./index-9203e50b.js";import{a as b}from"./axios-2ea3ab6f.js";const ae={class:"card"},oe=o("h4",{class:"m-0"},"域名列表",-1),ie={class:"flex flex-wrap gap-2 align-items-center justify-content-between"},ne={class:"p-input-icon-left"},se=o("i",{class:"pi pi-search"},null,-1),de={class:"p-buttonset"},ue={class:"card flex flex-wrap justify-content-center gap-3"},ce=["for"],me={class:"field"},re=o("label",{for:"point"},"积分",-1),ve={class:"field"},fe=o("label",{for:"comment"},"域名介绍",-1),pe={class:"field"},ge=o("label",{for:"dns"},"DNS解析平台",-1),_e={class:"field"},he=o("label",{for:"domain"},"选择域名",-1),be={class:"field"},ye=o("label",{for:"domain"},"分配角色",-1),De={class:"card flex flex-wrap justify-content-center gap-3"},Ce=["for"],Se={class:"field"},Ve=o("label",{for:"point"},"积分",-1),xe={class:"field"},Re=o("label",{for:"comment"},"域名介绍",-1),ke=o("p",null," 确认后，该域名的所有记录都将被删除，确认删除该域名？ ",-1),Te={__name:"DomainList",setup(we){const N=s(),c=s(),L=s([]),R=s(),E=s([]),k=s(),w=s(),f=s([]),g=s(),_=s(),y=s(!1),D=s(!1),C=s(!1),u=Z();ee();const I=s({global:{value:null,matchMode:te.CONTAINS}});le(()=>{h(),$(),q()});const $=()=>{b.get("/role/list",{params:{page:1,pageSize:10}}).then(function(a){w.value=a.data.data.records}).catch(function(a){console.log(a)})},h=()=>{b.get("/domain/list",{params:{page:1,pageSize:10}}).then(function(a){N.value=a.data.data.records}).catch(function(a){console.log(a)})},j=(a,e,v,d)=>{b.put("/domain/update",{id:a,roleIds:e,point:v,comment:d}).then(function(i){i.data.code===200?(y.value=!1,c.value={},u.add({severity:"success",summary:"SUCCESS",detail:i.data.msg,life:3e3})):(console.log(i.data),u.add({severity:"error",summary:"ERROR",detail:i.data.msg,life:3e3})),h()}).catch(function(i){h(),console.log(i)})},A=(a,e,v,d,i,n)=>{b.post("/domain/add",{dns:a,domainId:e,name:v,roleIds:d,point:i,comment:n}).then(function(p){p.data.code===200?(D.value=!1,c.value={},u.add({severity:"success",summary:"SUCCESS",detail:p.data.msg,life:3e3})):(console.log(p.data),u.add({severity:"error",summary:"ERROR",detail:p.data.msg,life:3e3})),h()}).catch(function(p){h(),console.log(p)})},G=a=>{b.delete("/domain/delete/"+a).then(function(e){e.data.code===200?(C.value=!1,c.value={},u.add({severity:"success",summary:"SUCCESS",detail:e.data.msg,life:3e3})):(console.log(e.data),u.add({severity:"error",summary:"ERROR",detail:e.data.msg,life:3e3})),h()}).catch(function(e){h(),console.log(e)})},K=a=>{b.get("/domain/list_from_dns",{params:{dns:a}}).then(function(e){e.data.code===200?(E.value=e.data.data,u.add({severity:"success",summary:"SUCCESS",detail:e.data.msg,life:3e3})):(console.log(e.data),u.add({severity:"error",summary:"ERROR",detail:e.data.msg,life:3e3}))}).catch(function(e){console.log(e)})},q=()=>{b.get("/domain_config/list",{params:{page:1,pageSize:10}}).then(function(a){a.data.code===200?L.value=a.data.data.records:(console.log(a.data),u.add({severity:"error",summary:"ERROR",detail:a.data.msg,life:3e3}))}).catch(function(a){console.log(a)})},U=()=>{y.value=!1,D.value=!1,C.value=!1,c.value={}},H=a=>{c.value=a,g.value=c.value.point,_.value=c.value.comment,y.value=!0},J=a=>{c.value=a,C.value=!0},Q=()=>{const a=c.value.id;let e=null;if(f.value==null)return u.add({severity:"error",summary:"ERROR",detail:"域名所属角色不能为空",life:3e3});e=String(f.value);const v=g.value,d=_.value;j(a,e,v,d)},W=()=>{const a=R.value.dns,e=k.value.domainId,v=k.value.name;let d;if(f.value==null)return u.add({severity:"error",summary:"ERROR",detail:"域名所属角色不能为空",life:3e3});d=String(f.value);const i=g.value,n=_.value;A(a,e,v,d,i,n)},X=()=>{const a=c.value.id;G(a)};return(a,e)=>{const v=m("Toolbar"),d=m("InputText"),i=m("Button"),n=m("Column"),p=m("DataTable"),Y=m("Toast"),P=m("Checkbox"),M=m("Textarea"),T=m("Dialog"),O=m("Dropdown");return V(),x("div",null,[o("div",ae,[t(v,{class:"mb-4"},{start:r(()=>[oe]),_:1}),t(p,{showGridlines:"",value:N.value,dataKey:"id",columnResizeMode:"fit",paginator:!0,rows:10,filters:I.value,paginatorTemplate:"FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink CurrentPageReport RowsPerPageDropdown",rowsPerPageOptions:[5,10,25],currentPageReportTemplate:"第 {first} 页，本页 {last} 条记录，共 {totalRecords} 条记录"},{header:r(()=>[o("div",ie,[o("span",ne,[se,t(d,{modelValue:I.value.global.value,"onUpdate:modelValue":e[0]||(e[0]=l=>I.value.global.value=l),placeholder:"搜索"},null,8,["modelValue"])]),t(i,{label:"添加",icon:"pi pi-plus",severity:"success",class:"mr-2",onClick:e[1]||(e[1]=l=>D.value=!0)})])]),default:r(()=>[t(n,{field:"id",header:"ID"}),t(n,{field:"dns",header:"DNS"}),t(n,{field:"domainId",header:"domainId"}),t(n,{field:"name",header:"域名"}),t(n,{field:"roleIds",header:"所属角色",style:{"min-width":"8rem"}}),t(n,{field:"point",header:"积分",style:{"min-width":"8rem"}}),t(n,{field:"comment",header:"介绍",style:{"min-width":"8rem"}}),t(n,{field:"createdTime",header:"创建时间",style:{"min-width":"12rem"}}),t(n,{field:"updatedTime",header:"更新时间",style:{"min-width":"12rem"}}),t(n,{exportable:!1,style:{"min-width":"24rem"}},{body:r(l=>[o("span",de,[t(i,{label:"编辑",icon:"pi pi-pencil",onClick:S=>H(l.data)},null,8,["onClick"]),t(i,{label:"删除",icon:"pi pi-trash",severity:"danger",onClick:S=>J(l.data)},null,8,["onClick"])])]),_:1})]),_:1},8,["value","filters"])]),t(Y),t(T,{visible:y.value,"onUpdate:visible":e[5]||(e[5]=l=>y.value=l),style:{width:"450px"},header:"更新用户",modal:!0,class:"p-fluid"},{footer:r(()=>[t(i,{text:"",label:"取消",icon:"pi pi-times",onClick:U}),t(i,{text:"",label:"确认",icon:"pi pi-check",onClick:Q})]),default:r(()=>[o("div",ue,[(V(!0),x(F,null,B(w.value,l=>(V(),x("div",{key:l.id,class:"flex align-items-center"},[t(P,{modelValue:f.value,"onUpdate:modelValue":e[2]||(e[2]=S=>f.value=S),inputId:String(l.id),name:"role",value:l.id},null,8,["modelValue","inputId","value"]),o("label",{for:l.id},z(l.roleName),9,ce)]))),128))]),o("div",me,[re,t(d,{id:"point",modelValue:g.value,"onUpdate:modelValue":e[3]||(e[3]=l=>g.value=l),modelModifiers:{trim:!0}},null,8,["modelValue"])]),o("div",ve,[fe,t(M,{id:"comment",modelValue:_.value,"onUpdate:modelValue":e[4]||(e[4]=l=>_.value=l),modelModifiers:{trim:!0},rows:"5",cols:"30"},null,8,["modelValue"])])]),_:1},8,["visible"]),t(T,{visible:D.value,"onUpdate:visible":e[12]||(e[12]=l=>D.value=l),style:{width:"450px"},header:"更新用户",modal:!0,class:"p-fluid"},{footer:r(()=>[t(i,{text:"",label:"取消",icon:"pi pi-times",onClick:U}),t(i,{text:"",label:"确认",icon:"pi pi-check",onClick:W})]),default:r(()=>[o("div",pe,[ge,t(O,{id:"dns",modelValue:R.value,"onUpdate:modelValue":e[6]||(e[6]=l=>R.value=l),options:L.value,optionLabel:"dns",placeholder:"请选择选择DNS解析平台",class:"w-full",autofocus:""},null,8,["modelValue","options"]),t(i,{label:"解析配置",icon:"pi pi-search",onClick:e[7]||(e[7]=l=>K(R.value.dns)),class:"mt-2"})]),o("div",_e,[he,t(O,{id:"domain",modelValue:k.value,"onUpdate:modelValue":e[8]||(e[8]=l=>k.value=l),options:E.value,optionLabel:"name",placeholder:"请选择域名",class:"w-full"},null,8,["modelValue","options"])]),o("div",be,[ye,o("div",De,[(V(!0),x(F,null,B(w.value,l=>(V(),x("div",{key:l.id,class:"flex align-items-center"},[t(P,{modelValue:f.value,"onUpdate:modelValue":e[9]||(e[9]=S=>f.value=S),inputId:String(l.id),name:"role",value:l.id},null,8,["modelValue","inputId","value"]),o("label",{for:l.id},z(l.roleName),9,Ce)]))),128))])]),o("div",Se,[Ve,t(d,{id:"point",modelValue:g.value,"onUpdate:modelValue":e[10]||(e[10]=l=>g.value=l),modelModifiers:{trim:!0}},null,8,["modelValue"])]),o("div",xe,[Re,t(M,{id:"comment",modelValue:_.value,"onUpdate:modelValue":e[11]||(e[11]=l=>_.value=l),modelModifiers:{trim:!0},rows:"5",cols:"30"},null,8,["modelValue"])])]),_:1},8,["visible"]),t(T,{visible:C.value,"onUpdate:visible":e[13]||(e[13]=l=>C.value=l),modal:"",header:"删除域名",style:{width:"450px"}},{footer:r(()=>[t(i,{label:"取消",icon:"pi pi-times",onClick:U,text:""}),t(i,{label:"确认",icon:"pi pi-check",onClick:X,autofocus:""})]),default:r(()=>[ke]),_:1},8,["visible"])])}}};export{Te as default};
