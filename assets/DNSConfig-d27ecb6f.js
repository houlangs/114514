import{a as D}from"./axios-99a7d01f.js";import{e as t,u as z,h as A,f as G,r as f,o as K,c as q,b as n,a as l,w as d}from"./index-8ffd0240.js";const H={class:"card"},Q=n("h4",{class:"m-0"},"DNS配置列表",-1),W={class:"p-buttonset"},X={class:"field"},Y=n("label",{for:"dns"},"DNS",-1),Z={class:"field"},ee={class:"field"},le={class:"field"},oe=n("label",{for:"dns"},"DNS",-1),ae={class:"field"},te={class:"field"},ne=n("p",null," 确认删除该DNS配置？ ",-1),ue={__name:"DNSConfig",setup(ie){const k=t(),u=t(),V=t(),T=t(),i=t(),w=t([{name:"CloudFlare"}]),S=t(),h=t(),r=t(),m=t(),p=t(!1),g=t(!1),b=t(!1),s=z();A(),G(()=>{v()});const x=()=>{if(i.value===void 0)return s.add({severity:"error",summary:"ERROR",detail:"DNS不能为空",life:3e3});switch(i.value.name){case"CloudFlare":S.value="email",h.value="key";break}},v=()=>{D.get("/domain_config/list").then(function(o){o.data.code===200?k.value=o.data.data.records:s.add({severity:"error",summary:"ERROR",detail:o.data.msg,life:3e3})}).catch(function(o){console.log(o)})},U=o=>{D.post("/domain_config/add",o).then(function(e){e.data.code===200?(g.value=!1,u.value="",s.add({severity:"success",summary:"SUCCESS",detail:e.data.msg,life:3e3})):(console.log(e.data),s.add({severity:"error",summary:"ERROR",detail:e.data.msg,life:3e3})),v()}).catch(function(e){v(),console.log(e)})},E=o=>{D.put("/domain_config/update",o).then(function(e){e.data.code===200?(p.value=!1,u.value="",s.add({severity:"success",summary:"SUCCESS",detail:e.data.msg,life:3e3})):(console.log(e.data),s.add({severity:"error",summary:"ERROR",detail:e.data.msg,life:3e3})),v()}).catch(function(e){v(),console.log(e)})},P=o=>{D.delete("/domain_config/delete/"+o).then(function(e){e.data.code===200?(b.value=!1,u.value="",s.add({severity:"success",summary:"SUCCESS",detail:e.data.msg,life:3e3})):(console.log(e.data),s.add({severity:"error",summary:"ERROR",detail:e.data.msg,life:3e3})),v()}).catch(function(e){v(),console.log(e)})},N=()=>{p.value=!1,g.value=!1,u.value=""},L=()=>{if(i.value===void 0)return s.add({severity:"error",summary:"ERROR",detail:"DNS不能为空",life:3e3});x();const o=i.value.name,e=JSON.stringify({[S.value]:r.value,[h.value]:m.value}),_={dns:o,config:e};console.log(r.value),console.log(m.value),U(_)},I=o=>{u.value=o,V.value=u.value.dns,i.value={name:V.value},T.value=JSON.parse(u.value.config),p.value=!0},M=()=>{if(i.value===void 0)return s.add({severity:"error",summary:"ERROR",detail:"DNS不能为空",life:3e3});x();const o=i.value.name,e=JSON.stringify({[S.value]:r.value,[h.value]:m.value}),_={dns:o,config:e};console.log(r.value),console.log(m.value),E(_)},B=o=>{u.value=o,b.value=!0},F=()=>{const o=u.value.dns;P(o)};return(o,e)=>{const _=f("Toolbar"),c=f("Button"),C=f("Column"),J=f("DataTable"),$=f("Toast"),O=f("Dropdown"),y=f("InputText"),R=f("Dialog");return K(),q("div",null,[n("div",H,[l(_,{class:"mb-4"},{start:d(()=>[Q]),_:1}),l(J,{showGridlines:"",value:k.value,dataKey:"dns",columnResizeMode:"fit",paginator:!0,rows:10,paginatorTemplate:"FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink CurrentPageReport RowsPerPageDropdown",rowsPerPageOptions:[5,10,25],currentPageReportTemplate:"第 {first} 页，本页 {last} 条记录，共 {totalRecords} 条记录"},{header:d(()=>[l(c,{label:"添加",icon:"pi pi-plus",severity:"success",class:"mr-2",onClick:e[0]||(e[0]=a=>g.value=!0)})]),default:d(()=>[l(C,{field:"dns",header:"DNS"}),l(C,{field:"config",header:"配置"}),l(C,{field:"createdTime",header:"添加时间",style:{"min-width":"12rem"}}),l(C,{field:"updatedTime",header:"更新时间",style:{"min-width":"8rem"}}),l(C,{exportable:!1,style:{"min-width":"24rem"}},{body:d(a=>[n("span",W,[l(c,{label:"编辑",icon:"pi pi-pencil",onClick:j=>I(a.data)},null,8,["onClick"]),l(c,{label:"删除",icon:"pi pi-trash",severity:"danger",onClick:j=>B(a.data)},null,8,["onClick"])])]),_:1})]),_:1},8,["value"])]),l($),l(R,{visible:g.value,"onUpdate:visible":e[4]||(e[4]=a=>g.value=a),style:{width:"450px"},header:"添加配置",modal:!0,class:"p-fluid"},{footer:d(()=>[l(c,{text:"",label:"取消",icon:"pi pi-times",onClick:N}),l(c,{text:"",label:"确认",icon:"pi pi-check",onClick:L})]),default:d(()=>[n("div",X,[Y,l(O,{id:"dns",modelValue:i.value,"onUpdate:modelValue":e[1]||(e[1]=a=>i.value=a),options:w.value,optionLabel:"name",placeholder:"请选择DNS",class:"w-full",autofocus:""},null,8,["modelValue","options"])]),n("div",Z,[l(y,{id:"account",modelValue:r.value,"onUpdate:modelValue":e[2]||(e[2]=a=>r.value=a),modelModifiers:{trim:!0},placeholder:"请输入账户"},null,8,["modelValue"])]),n("div",ee,[l(y,{id:"secret",modelValue:m.value,"onUpdate:modelValue":e[3]||(e[3]=a=>m.value=a),modelModifiers:{trim:!0},placeholder:"请输入密钥"},null,8,["modelValue"])])]),_:1},8,["visible"]),l(R,{visible:p.value,"onUpdate:visible":e[8]||(e[8]=a=>p.value=a),style:{width:"450px"},header:"更新配置",modal:!0,class:"p-fluid"},{footer:d(()=>[l(c,{text:"",label:"取消",icon:"pi pi-times",onClick:N}),l(c,{text:"",label:"确认",icon:"pi pi-check",onClick:M})]),default:d(()=>[n("div",le,[oe,l(O,{id:"dns",modelValue:i.value,"onUpdate:modelValue":e[5]||(e[5]=a=>i.value=a),options:w.value,optionLabel:"name",placeholder:"请选择DNS",class:"w-full",autofocus:""},null,8,["modelValue","options"])]),n("div",ae,[l(y,{id:"account",modelValue:r.value,"onUpdate:modelValue":e[6]||(e[6]=a=>r.value=a),modelModifiers:{trim:!0},placeholder:"请输入账户"},null,8,["modelValue"])]),n("div",te,[l(y,{id:"secret",modelValue:m.value,"onUpdate:modelValue":e[7]||(e[7]=a=>m.value=a),modelModifiers:{trim:!0},placeholder:"请输入密钥"},null,8,["modelValue"])])]),_:1},8,["visible"]),l(R,{visible:b.value,"onUpdate:visible":e[9]||(e[9]=a=>b.value=a),modal:"",header:"删除DNS配置",style:{width:"450px"}},{footer:d(()=>[l(c,{label:"取消",icon:"pi pi-times",onClick:N,text:""}),l(c,{label:"确认",icon:"pi pi-check",onClick:F,autofocus:""})]),default:d(()=>[ne]),_:1},8,["visible"])])}}};export{ue as default};
